/*create view that returns the names and ids of individuals who have not been fully*/ vaccinated - see fully_vaccinated_view*/
/*make positive_tests_count_view more complex - e.g include names of individuals and dates of positive tests, order by test date*/
/*create view determining compliance - sort individuals who are in compliance by ensuring that they hve not had a positive test in 14 days, reported any symptoms in 14 days, adn completed the training*/
/*create view to see if any reportd close contacts are umd individuals that have visited campus*/

CREATE VIEW PERSON_VIEW AS
SELECT name, age, affiliation, training status, DATETIME.
FROM  PERSON;
SELECT * FROM PERSON_VIEW;


CREATE VIEW VACCINATION_VIEW AS
SELECT vaccinated, vaccinated type, dose 1 DATETIME, dose 2 DATETIME,
FROM  VACCINATED;
SELECT * FROM VACCINATED_VIEW;

CREATE VIEW SYMPTOMS_VIEW AS
SELECT symptom_name,
FROM SYMPTOMS
SELECT * FROM SYMPTOMS_VIEW;


CREATE VIEW TESTING_VIEW AS
SELECT testing_id, univ_id, test_result,test_date,
FROM TESTING
SELECT * FROM TESTING_VIEW;


CREATE VIEW BUILDINGS_VIEW AS
SELECT building_id, building_name,
FROM BUILDINGS;
SELECT*FROM BUILDINGS_VIEW;

/*working, but very simple. Want to join it with peron.univ_id so we can see who obtained the positive tests. Order by most recent test date.*/
DROP VIEW IF EXISTS positive_tests_view;
create view positive_tests_view as
select count(test_result) as num_pos_test
from testing
where test_result =1
;
select * from positive_tests_view


/*fully working*/
DROP VIEW IF EXISTS fully_vaccinated_view;
CREATE VIEW fully_vaccinated_view AS
SELECT v.univ_id, sq.full_name, v.vaccination_type,  v.dose_1_date, v.dose_2_date
from vaccination v
inner join
(select p.univ_id, concat(last_name,', ', first_name) as full_name 
from person p) sq
on v.univ_id = sq.univ_id
where v.vaccination_type is not null
and v.dose_2_date is not null or v.vaccination_type = 3
order by univ_id
;
SELECT * FROM fully_vaccinated_VIEW;

/*fully working but very simple*/
DROP VIEW IF EXISTS positive_tests_count_view;
create view positive_tests_count_view as
select count(test_result) as num_pos_test
from testing
where test_result =1
;
select * from positive_tests_count_view;
